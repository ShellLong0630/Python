import re,jft

#----繁简体转换
##file1 = 'D:\\张玉龙\\Python\\20140421_tag.txt'
##file2 = 'D:\\张玉龙\\Python\\20140421_tag_j.txt'
##f1    = open(file1,'r',encoding='utf-8')
##f2    = open(file2,'w',encoding='utf-8')
##
##for s in f1:
##    f2.write(jft.f2j('utf8','utf8',s))
##    #print(jft.f2j('utf8','utf8',s))
##f2.close()
##f3 = open(file2,'r',encoding='utf-8')
##a = []
##for s in f3:
##    if re.findall('2014-04-21 12:00:00',s):
##        a.append(i for i in s.split('"')[-2].split(','))
##
##a = set(a)
##print(a)
##
##f1.close()
##f3.close()
#----生成sql
file1 = 'D:\\张玉龙\\Python\\20140421_tag_j.txt'
file2 = 'D:\\张玉龙\\Python\\提交\\20140422_UPDATE_catId.sql'
f1    = open(file1,'r',encoding='utf-8')
f2    = open(file2,'w',encoding='utf-8')
catIddic   = {11:11,15:11,16:11,22:11,26:11,27:11,30:11,34:0,35:34,37:34,38:34,40:40,41:41,43:43,44:44,47:40,50:34,51:34,52:34,54:34,
            55:34,59:18,61:18,62:18,63:11,66:18,72:18,75:18,76:76,77:76,78:76,79:76,81:183,83:183,84:208,85:183,89:43,90:43,
            92:43,93:43,97:44,98:44,99:44,100:44,101:44,113:41,115:34,130:11,131:11,132:11,133:11,134:11,135:34,138:18,
            139:41,142:183,144:43,145:43,146:43,148:0,149:40,150:44,151:0,152:151,153:151,154:151,155:151,156:151,
            157:151,158:151,159:151,160:151,161:151,162:41,165:41,166:41,167:41,168:41,170:138,175:11,177:34,178:183,
            179:11,180:208,181:40,183:183,185:83,187:83,188:83,189:83,190:83,191:83,192:83,193:83,194:83,195:83,196:83,
            197:83,198:83,199:83,200:83,201:83,203:183,204:183,205:34,206:34,207:151,208:208,209:208,210:208,212:40,
            213:40,214:40,216:34,217:11,218:11,219:11,221:18,222:41,223:34,224:34,225:34,226:183,227:34,229:76,230:41,
            232:18,233:41,234:18,235:41,236:41,237:41,238:41,239:34,240:34,241:34,242:34,243:183,244:183,245:183,
            246:183,247:183,248:183,249:183,250:183,252:43,253:44,254:44,255:44,256:40,257:40,258:40,259:151,260:151,
            261:151,262:151,263:208,264:208,265:208,266:208,267:208,268:208,269:76,270:76,271:76,272:40}
dic = {'喜剧俱乐部':62,'街坊':162,'图书馆':146,'「课程/工作坊」':235,'市政中心':78,'越野/沙滩车步道':255,'观光巴士':255,'葡萄酒庄':59,'自然历史博物馆':113,
'喷泉':162,'自然保育区':162,'其他':162,'政府机关':78,'步道':162,'Attraction':162,'商店':35,'交响乐':62,'歌剧':62,'动物园':165,'海滩':168,'科学博物馆':113,
'墓园':162,'名产店':35,'公园':162,'山谷':162,'渡轮/船':255,'农场':162,'教堂/大教堂':162,'观景台/天文台':162,'大峡谷':162,'芭蕾舞':62,'保龄球馆':207,
'教育施设':252,'Spa':234,'观景台/塔':162,'演唱会':62,'水上乐园':167,'同性恋酒吧':59,'竞技场/体育场':161,'牧场':162,'运动营/健诊营':152,'大众交通':255,
'瀑布':162,'画廊':139,'军事基地/设施':162,'爵士酒吧':59,'儿童博物馆':113,'宗教地点':162,'舞厅/迪斯可':238,'剧场':62,'游戏/娱乐中心':238,'渡假中心':162,
'艺术建筑':162,'船舶':255,'单车步道':255,'健行步道':255,'铁路旅游':162,'纪念碑/雕像':162,'马术步道':162,'岛屿':162,'瞭望台':162,'健身中心':152,'步行游览':162,
'大洞穴/洞窟':162,'迪士尼':167,'城堡':162,'钢琴酒吧':59,'赌场':238,'军事博物馆':113,'森林':162,'天然涌泉/温泉':162,'海湾':162,'电影院':61,'历史博物馆':113,
'沙漠':162,'旅客服务中心':162,'畅货中心':242,'乡村酒吧':59,'空城':162,'会议中心':271,'酒吧/俱乐部':59,'马廄':162,'百货公司':35,'自驾旅游':162,'慢跑步道':255,
'水上运动':262,'餐馆剧院':62,'山脉':162,'历史古蹟':162,'国家公园':162,'冲浪营地':162,'花园':162,'购物中心':35,'游艇':162,'啤酒厂':229,'预约式':162,'博物馆':113,
'综合体育馆':161,'滑雪区':160,'桥樑':162,'水坝':162,'地标/景点':162,'交通工具':255,'Segway旅游':162,'跳蚤市场/露天市集':242,'酿酒厂':229,'古代遗址':162,
'灵异景点':162,'赛车场':162,'越野滑雪区':160,'战地史迹':162,'高尔夫球场':154,'灯塔':162,'徒步观景区':162,'古董店':216,'珊瑚礁':162,'表演':62,'旅游':162,
'岩矿观光':162,'码头/堤防/人行道':162,'咖啡馆':22,'美术馆':139,'州立公园':162,'矿山':162,'赛狗场':162,'主题乐园':167,'码头':98,'工厂参访':229,'雪茄吧':238,
'特色博物馆':113,'史迹徒步区':162}
#b = []
for s in f1:
    if re.findall('2014-04-21 12:00:00',s):
        a = []
        for i in s.split('"')[-2].split(','):
            a.append(dic[i])
        sql = 'UPDATE townfile_local SET catId = %s, parentId = %s,updateTime = "2014-04-22 14:00:00" WHERE localId = %s;\n'% (a[0],catIddic[a[0]],s.split(',')[0])
        #b.append(catIddic[a[0]])
        f2.write(sql)
#print(set(b))
f1.close()
f2.close()
